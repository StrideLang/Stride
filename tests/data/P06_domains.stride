use DesktopAudio version 1.0

signal ValueInOSCDomain {
    domain: OSCDomain
}

module TestMod {
  ports:          [
    mainOutputPort OutputPort {
        block:      Output
    }
    propertyInputPort ValuePort {
        name: "value"
        block:      Value
    }
  ]
  blocks:         []
  streams: [
            Value >> Output;
  ]
}

module TestMod2 {
  ports:          [
    mainOutputPort OutputPort {
        block:      Output
    }
    mainInputPort InputPort {
        block:      Input
    }
    propertyInputPort ValuePort {
        name: "value"
        block:      Value
    }
  ]
  blocks:         [
      signal Input[2] {}
  ]
  streams: [
            Input[1] * Input[2] * Value >> Output;
  ]
}

[ TestMod(value: 10) , 1024.0] >> TestMod2(value: 1.5) >> ValueInOSCDomain;

TestMod(value: ValueInOSCDomain) >> AudioOut;

# Domain propagates from AudioOut to Modulator

signal Modulator {}
TestMod(value: 5) >> Modulator;
TestMod(value:Modulator) >> AudioOut;

# Domain of Signal is None, as TestMod2 pulls domain from output
AudioIn[1] >> TestMod2(value: 0.1) >> Signal;

# This has two domain changes. Currently this is split into two
# separate streams as it makes code generation easier.
AudioIn[1] >> ValueInOSCDomain >> AudioOut[2];
